<h1 class="heading-large">
  <%= t(".heading") %>
</h1>

<div class="grid-row">
  <div class="column-full">
    <div class="panel">
      <p>TODO: Search</p>
    </div>

    <% if @transient_registrations.present? %>
      <table>
        <thead>
          <tr>
            <th><%= t(".results.th.reg_identifier") %></th>
            <th><%= t(".results.th.company_name") %></th>
            <th><%= t(".results.th.status") %></th>
            <th><%= t(".results.th.last_modified") %></th>
            <th><%= t(".results.th.actions") %></th>
          </tr>
        </thead>
        <tbody>
          <% @transient_registrations.each do |transient_registration| %>
            <tr>
              <td>
                <%= transient_registration.reg_identifier %>
              </td>
              <td>
                <%= transient_registration.company_name %>
              </td>
              <td>
                <% if renewal_application_submitted?(transient_registration) %>
                    <% if transient_registration.finance_details.balance.positive? %>
                      <strong class="app-c-tag app-c-tag--success">
                        <%= t(".results.statuses.pending_payment") %>
                      </strong>
                    <% end %>
                    <% if transient_registration.conviction_check_required? %>
                      <strong class="app-c-tag app-c-tag--warning">
                        <%= t(".results.statuses.pending_convictions_check") %>
                      </strong>
                    <% end %>
                <% else %>
                  <strong class="app-c-tag">
                    <%= t(".results.statuses.in_progress") %>
                  </strong>
                <% end %>
              </td>
              <td>
                <%= transient_registration.metaData.last_modified.strftime("%H:%M %d/%m/%Y") %>
              </td>
              <td>
                <%= link_to t(".results.details_button"), transient_registration_path(transient_registration.reg_identifier), class: 'button' %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% end %>
  </div>
</div>

<%= paginate @transient_registrations %>
